{
  "iam_permissions_matrix": {
    "roles": {
      "ecs_execution_role": {
        "name": "mistersmith-ecs-execution-role",
        "trust_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "ecs-tasks.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "managed_policies": [
          "arn:aws:iam::aws:policy/service-role/AmazonECSTaskExecutionRolePolicy"
        ],
        "inline_policies": {
          "secrets_access": {
            "Version": "2012-10-17",
            "Statement": [
              {
                "Effect": "Allow",
                "Action": [
                  "secretsmanager:GetSecretValue"
                ],
                "Resource": [
                  "arn:aws:secretsmanager:us-east-1:*:secret:mistersmith/*"
                ]
              }
            ]
          }
        }
      },
      "ecs_task_role": {
        "name": "mistersmith-ecs-task-role",
        "trust_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "ecs-tasks.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "permissions": {
          "logs": [
            "logs:CreateLogGroup",
            "logs:CreateLogStream",
            "logs:PutLogEvents",
            "logs:DescribeLogStreams"
          ],
          "ssm": [
            "ssmmessages:CreateControlChannel",
            "ssmmessages:CreateDataChannel",
            "ssmmessages:OpenControlChannel",
            "ssmmessages:OpenDataChannel"
          ],
          "dynamodb": [
            "dynamodb:GetItem",
            "dynamodb:PutItem",
            "dynamodb:UpdateItem",
            "dynamodb:Query",
            "dynamodb:Scan",
            "dynamodb:BatchGetItem",
            "dynamodb:BatchWriteItem",
            "dynamodb:DescribeTable",
            "dynamodb:DescribeStream",
            "dynamodb:GetRecords",
            "dynamodb:GetShardIterator",
            "dynamodb:ListStreams"
          ],
          "sqs": [
            "sqs:SendMessage",
            "sqs:SendMessageBatch",
            "sqs:ReceiveMessage",
            "sqs:DeleteMessage",
            "sqs:DeleteMessageBatch",
            "sqs:GetQueueAttributes",
            "sqs:GetQueueUrl",
            "sqs:ChangeMessageVisibility",
            "sqs:ChangeMessageVisibilityBatch"
          ],
          "eventbridge": [
            "events:PutEvents",
            "events:PutTargets",
            "events:PutRule",
            "events:DescribeRule",
            "events:ListRules",
            "events:ListTargetsByRule"
          ],
          "s3": [
            "s3:GetObject",
            "s3:PutObject",
            "s3:DeleteObject",
            "s3:ListBucket",
            "s3:GetObjectVersion",
            "s3:PutObjectAcl"
          ],
          "secrets": [
            "secretsmanager:GetSecretValue",
            "secretsmanager:DescribeSecret"
          ],
          "kms": [
            "kms:Decrypt",
            "kms:DescribeKey"
          ]
        }
      },
      "rds_proxy_role": {
        "name": "mistersmith-rds-proxy-role",
        "trust_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "rds.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "managed_policies": [
          "arn:aws:iam::aws:policy/SecretsManagerReadWrite"
        ]
      },
      "auto_scaling_role": {
        "name": "mistersmith-auto-scaling-role",
        "trust_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "application-autoscaling.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "permissions": {
          "ecs": [
            "ecs:UpdateService",
            "ecs:DescribeServices"
          ],
          "cloudwatch": [
            "cloudwatch:GetMetricStatistics",
            "cloudwatch:ListMetrics"
          ]
        }
      },
      "rds_monitoring_role": {
        "name": "mistersmith-rds-monitoring-role",
        "trust_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "monitoring.rds.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "managed_policies": [
          "arn:aws:iam::aws:policy/service-role/AmazonRDSEnhancedMonitoringRole"
        ]
      },
      "lambda_execution_role": {
        "name": "mistersmith-lambda-execution-role",
        "trust_policy": {
          "Version": "2012-10-17",
          "Statement": [
            {
              "Effect": "Allow",
              "Principal": {
                "Service": "lambda.amazonaws.com"
              },
              "Action": "sts:AssumeRole"
            }
          ]
        },
        "managed_policies": [
          "arn:aws:iam::aws:policy/service-role/AWSLambdaVPCAccessExecutionRole"
        ],
        "permissions": {
          "eventbridge": [
            "events:PutEvents"
          ],
          "sqs": [
            "sqs:SendMessage",
            "sqs:ReceiveMessage",
            "sqs:DeleteMessage",
            "sqs:GetQueueAttributes"
          ],
          "dynamodb": [
            "dynamodb:GetItem",
            "dynamodb:PutItem",
            "dynamodb:UpdateItem",
            "dynamodb:Query"
          ]
        }
      }
    },
    "service_linked_roles": [
      "arn:aws:iam::aws:policy/aws-service-role/AmazonECSServiceRolePolicy",
      "arn:aws:iam::aws:policy/aws-service-role/AmazonRDSServiceRolePolicy",
      "arn:aws:iam::aws:policy/aws-service-role/ElasticLoadBalancingServiceRolePolicy"
    ],
    "cross_account_access": {
      "enabled": false,
      "trusted_accounts": [],
      "external_id_required": true
    },
    "permission_boundaries": {
      "name": "mistersmith-permission-boundary",
      "policy": {
        "Version": "2012-10-17",
        "Statement": [
          {
            "Effect": "Allow",
            "Action": "*",
            "Resource": "*",
            "Condition": {
              "StringEquals": {
                "aws:RequestedRegion": "us-east-1"
              }
            }
          },
          {
            "Effect": "Deny",
            "Action": [
              "iam:DeleteRole",
              "iam:DeleteRolePolicy",
              "iam:DeleteUserPolicy",
              "iam:DeleteGroupPolicy"
            ],
            "Resource": "*"
          }
        ]
      }
    }
  }
}